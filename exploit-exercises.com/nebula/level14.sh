#!/bin/bash
##
# the encryption scheme simply adds the character position,
# starting at zero, to each character given.
#
# to decrypt you simply reverse this by decreasing each character
# by its character position.
##

# get the token to decrypt
A=$(echo -n `cat ~flag14/token | tr -d '\n'`)

# the C program to decrypt
C="#include <stdio.h>

int
main(void)
{
  int i = 0; /* start at the begining */
  /* the contents of /home/flag14/token */
  char *e = \"${A}\";

  while(e[i + 1] != '\0') /* loop through each character */
    /* increment the current value by it's index */
    printf(\"%c\", e[i] - i++);
  printf(\"\\n\");

  return 0;
}"

# have we created the C file?
if [[ ! -f level.c ]]; then
  echo "${C}" > level14.c
fi

# compile and run it
gcc -o level14 level14.c && ./level14
rm -f level14 # remove the executable
