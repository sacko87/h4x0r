#!/usr/bin/python
import sys
import struct
import socket

# create a socket to connect to the service
client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# connect the the service
client.connect((sys.argv[1], 2996))

# send the attack
# > 2 bytes is the length of the packet
client.send('\x00\x1f')
# > 1 byte to dictate the command
client.send('\x17')
# > three null-terminated elements preceeded
#   with their length using one byte.
#   > resource: 'net3'
client.send('\x05net3\x00')
#   > username: 'awesomesauce'
client.send('\x0dawesomesauce\x00')
#   > password: 'password'
client.send('\x09password\x00')

# get the response
result = client.recv(256)
print result[2:]

# finally close
client.close()
